(()=>{"use strict";var e={389:(e,t,n)=>{n.r(t)},857:(e,t)=>{t.__esModule=!0,t.changeListeners=void 0,t.changeListeners=function(e){var t=e.document;e.dispatch,e.getState,t.addEventListener("input",(function(e){e.target,HTMLElement}))}},407:(e,t)=>{t.__esModule=!0,t.clickListeners=void 0,t.clickListeners=function(e){var t=e.document,n=e.dispatch;e.getState,t.addEventListener("click",(function(e){var t,a,o=e.target;if(o instanceof HTMLElement){if(o.matches("#duedate button")&&(e.preventDefault(),e.stopPropagation()),o.matches(".tilelist header")&&(e.preventDefault(),console.log("toggling active class"),null===(t=o.closest(".tilelist"))||void 0===t||t.classList.toggle("active")),o.matches("#settings li")){var r=o.getAttribute("data-settings");switch(null===(a=o.closest(".tilelist"))||void 0===a||a.classList.toggle("active"),r){default:return;case"clear-suggestions":return null==n?void 0:n({type:"CLEAR_SETTINGS",payload:"suggestions"});case"clear-todos":return null==n?void 0:n({type:"CLEAR_SETTINGS",payload:"todos"});case"clear-all":return null==n?void 0:n({type:"CLEAR_SETTINGS",payload:"all"});case"add-category":var i=prompt("Enter new category name");"string"==typeof i&&i.length&&(null==n||n({type:"ADD_CATEGORY",payload:i}))}}if(o.matches(".deleteTodo")){var s=o.closest("[data-todo-id]");if(s instanceof HTMLElement){var l=s.getAttribute("data-todo-id");l&&(null==n||n({type:"REMOVE_TODO",payload:l}))}}o.matches("#duedate button")&&(null==n||n({type:"UPDATE_FORM",payload:{name:"duedate",value:null}}))}}))}},225:(e,t)=>{t.__esModule=!0,t.focusListeners=void 0,t.focusListeners=function(e){var t=e.document;e.dispatch,e.getState,t.addEventListener("focusin",(function(e){var t=e.target;if(t instanceof HTMLElement&&t instanceof HTMLInputElement&&t.matches(".overflow")){var n=Number(t.getAttribute("data-selectionStart")),a=Number(t.getAttribute("data-selectionEnd"));t.setSelectionRange(n,a),t.removeAttribute("data-selectionStart"),t.removeAttribute("data-selectionEnd")}})),t.addEventListener("focusout",(function(e){var t=e.target;t instanceof HTMLElement&&t instanceof HTMLInputElement&&t.matches(".overflow")&&(t.setAttribute("data-selectionStart",String(t.selectionStart)),t.setAttribute("data-selectionEnd",String(t.selectionEnd)),t.selectionStart=0,t.selectionEnd=0)}))}},302:(e,t,n)=>{t.__esModule=!0,t.attachEventListeners=void 0;var a=n(857),o=n(407),r=n(225),i=n(593),s=n(104),l=n(605);t.attachEventListeners=function(e){(0,o.clickListeners)(e),(0,r.focusListeners)(e),(0,i.inputListeners)(e),(0,l.submitListeners)(e),(0,a.changeListeners)(e),(0,s.keydownListeners)(e)}},593:(e,t,n)=>{t.__esModule=!0,t.inputListeners=void 0;var a=n(175);t.inputListeners=function(e){var t=e.document,n=e.dispatch;e.getState,t.addEventListener("input",(function(e){var t,o=e.target;o instanceof HTMLElement&&o instanceof HTMLInputElement&&(o.matches("#username")&&(null==n||n({type:"UPDATE_USERNAME",payload:o.value})),o.matches("#newTodoForm input")&&(null==o?void 0:o.name)&&(o.matches(".tilelist input")&&(e.preventDefault(),null===(t=o.closest(".tilelist"))||void 0===t||t.classList.remove("active")),null==n||n({type:"UPDATE_FORM",payload:{name:o.name,value:o.value}})),o.matches("#todoList input[type=checkbox]")&&(0,a.andThen)((0,a.andThen)((0,a.maybeHtmlElement)(o.closest("[data-todo-id]")),(function(e){return e.getAttribute("data-todo-id")})),(function(e){return null==n?void 0:n({type:"TOGGLE_TODO_DONE",payload:e})})))}))}},104:(e,t)=>{t.__esModule=!0,t.keydownListeners=void 0,t.keydownListeners=function(e){var t=e.document;e.dispatch,e.getState,t.addEventListener("keydown",(function(e){var n=e.target;if(n instanceof HTMLInputElement&&n.matches("#assignedto-input")&&"tab"===e.key.toLowerCase()){var a=t.getElementById("assignedto-shadow");a instanceof HTMLInputElement&&a.value.length&&(e.preventDefault(),n.value=a.value)}}))}},605:function(e,t,n){var a=this&&this.__assign||function(){return a=Object.assign||function(e){for(var t,n=1,a=arguments.length;n<a;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},a.apply(this,arguments)};t.__esModule=!0,t.submitListeners=void 0;var o=n(983);t.submitListeners=function(e){var t=e.document,n=e.dispatch,r=e.getState;t.addEventListener("submit",(function(e){var t=e.target;if(t instanceof HTMLElement&&t.matches("#newTodoForm")){e.preventDefault();var i=null==r?void 0:r().form.data;if(!i)throw new Error("This should probably be an impossible state, brud.");t.querySelectorAll("input[type=text]").forEach((function(e){e instanceof HTMLInputElement&&(e.value="")}));var s=t.querySelector("input[type=text]");null==s||s.focus(),null==n||n({type:"ADD_TODO",payload:a({id:(0,o.nanoid)()},i)})}}))}},718:function(e,t,n){var a=this&&this.__assign||function(){return a=Object.assign||function(e){for(var t,n=1,a=arguments.length;n<a;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},a.apply(this,arguments)},o=this&&this.__rest||function(e,t){var n={};for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&t.indexOf(a)<0&&(n[a]=e[a]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var o=0;for(a=Object.getOwnPropertySymbols(e);o<a.length;o++)t.indexOf(a[o])<0&&Object.prototype.propertyIsEnumerable.call(e,a[o])&&(n[a[o]]=e[a[o]])}return n};t.__esModule=!0,t.saveState=t.loadState=void 0;var r=n(175),i=n(992),s="saved-todo-state";t.loadState=function(){var e=localStorage.getItem(s);if(null===e)return i.defaultState;var t=(0,r.tryCatch)((function(){return JSON.parse(e)})),n=t.result;return t.error,n?a(a({},i.defaultState),n):i.defaultState},t.saveState=function(e){var t=e.username,n=e.todos,a=e.categories,r=e.selectedCategory,i=e.previouslyAssigned,l=(o(e,["username","todos","categories","selectedCategory","previouslyAssigned"]),{username:t,todos:n,categories:a,selectedCategory:r,previouslyAssigned:i});localStorage.setItem(s,JSON.stringify(l))}},175:(e,t)=>{t.__esModule=!0,t.$if=t.toggleClass=t.maybeInputElement=t.maybeHtmlElement=t.andThen=t.tryCatch=void 0,t.tryCatch=function(e){try{return{result:e(),error:null}}catch(e){return{result:null,error:String(e)}}},t.andThen=function(e,t){return null==e?null:t(e)},t.maybeHtmlElement=function(e){return e instanceof HTMLElement?e:null},t.maybeInputElement=function(e){return e instanceof HTMLInputElement?e:null},t.toggleClass=function(e,t){return function(n){n.classList.toggle(e,t)}},t.$if=function(e,t){return e?t():null}},809:(e,t)=>{t.__esModule=!0,t.render=void 0;var n=null;t.render=function(e){var t,a,o,r,i,s;if(console.log("=== RENDER ==="),e.username!==(null==n?void 0:n.username)){document.title=e.username?"".concat(e.username,"â€™s Tasks"):"Your Tasks";var l=document.querySelector(".greeting input");l instanceof HTMLInputElement&&(l.value=e.username)}if(e.todos!==(null==n?void 0:n.todos)){var u=document.getElementById("todoList");u instanceof HTMLElement&&(u.innerHTML="<ul>"+e.todos.map((function(e){return"\n          <li>\n            <label data-todo-id=".concat(e.id,'>\n              <div>\n                <input\n                  type="checkbox"\n                  name="category"\n                  value="').concat(e.id,'"\n                  ').concat(e.done?"checked":"",'\n                />\n                <b class="bubble"></b>\n                ').concat(e.title,'\n              </div>\n              <button type="button" class="deleteTodo">\n                <i class="fa fa-trash"></i>\n              </button>\n            </label>\n          </li>')})).join("\n")+"</ul>")}if(e.form.data!==(null==n?void 0:n.form.data)){console.log("dirty form!");var c=e.form.data.assignedto,d=document.getElementById("assignedto-shadow");if(d instanceof HTMLInputElement){var f=c.length&&null!==(t=e.previouslyAssigned.find((function(e){return!!e.match(c)})))&&void 0!==t?t:"";console.log("dirty shadow:",c,f,d.value),d.value=f}}if(e.form.data.duedate!==(null===(o=null===(a=null==n?void 0:n.form)||void 0===a?void 0:a.data)||void 0===o?void 0:o.duedate)){var g=document.querySelector("#duedate"),v=e.form.data.duedate;g&&(g.innerHTML=function(e){var t=(new Date).toISOString().slice(0,10);return null===e?'<label>\n        <span>Select a due date?</span>\n        <input type="date" name="duedate" min="'.concat(t,'"/>\n      </label>'):"<label>\n      <span>".concat(e,'</span>\n      <input type="date" name="duedate" value="').concat(e,'" min="').concat(t,'"/>\n    </label>\n    <button type="button">\n      <i class="fa fa-close"></i>\n    </button>')}(v))}if(e.categories!==(null==n?void 0:n.categories)||e.selectedCategory!==(null==n?void 0:n.selectedCategory)){console.log("rerendering the category list");var p=document.querySelector("#categories header"),m=document.querySelector("#categories ul");p instanceof HTMLElement&&m instanceof HTMLElement&&(p.innerText=null!==(i=null===(r=e.categories.find((function(t){return t.id===e.selectedCategory})))||void 0===r?void 0:r.name)&&void 0!==i?i:"",m.innerHTML=e.categories.map((s=e.selectedCategory,function(e){return'<li>\n              <label>\n                <input\n                  type="radio"\n                  name="category"\n                  value="'.concat(e.id,'"\n                  ').concat(e.id===s?"checked":"",'\n                  required\n                />\n                <b class="bubble" ></b>\n                ').concat(e.name,"\n              </label>\n            </li>")})).join("\n"),e.categories.length>4?m.classList.add("dropdown"):m.classList.remove("dropdown"))}n=e,document.body.classList.remove("loading")}},731:function(e,t,n){var a=this&&this.__assign||function(){return a=Object.assign||function(e){for(var t,n=1,a=arguments.length;n<a;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},a.apply(this,arguments)};t.__esModule=!0,t.createStore=t.getEmptyFormData=t.configureStore=void 0;var o=n(983),r=n(714);function i(e){var t=e.initialState,n=e.reducer,a=t,r=[];return{dispatch:function(e){var t=n(a,e);console.log("dispatched; rerender?",t!==a),console.log(JSON.stringify(a,null,2)),console.log(JSON.stringify(t,null,2)),t!==a&&(a=t,r.forEach((function(e){return(0,e.fn)(a)})))},subscribe:function(e){var t=(0,o.nanoid)();return r.push({id:t,fn:e}),e(a),function(){r.filter((function(e){return e.id!==t}))}},getState:function(){return a}}}t.configureStore=i;var s={title:"",category:"",done:!1,duedate:null,assignedto:""};t.getEmptyFormData=function(e){return a(a({},s),{category:e})},t.createStore=function(e){return i({initialState:e,reducer:r.reducer})}},714:function(e,t,n){var a=this&&this.__assign||function(){return a=Object.assign||function(e){for(var t,n=1,a=arguments.length;n<a;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},a.apply(this,arguments)},o=this&&this.__spreadArray||function(e,t,n){if(n||2===arguments.length)for(var a,o=0,r=t.length;o<r;o++)!a&&o in t||(a||(a=Array.prototype.slice.call(t,0,o)),a[o]=t[o]);return e.concat(a||Array.prototype.slice.call(t))};t.__esModule=!0,t.reducer=void 0;var r=n(983),i=n(731),s=n(992);t.reducer=function(e,t){var n,l=t.type,u=t.payload;switch(l){default:return e;case"UPDATE_USERNAME":return a(a({},e),{username:u});case"UPDATE_FORM":return a(a({},e),{selectedCategory:"category"===u.name&&null!==u.value?u.value:e.selectedCategory,form:a(a({},e.form),{data:a(a({},e.form.data),(n={},n[u.name]=u.value,n))})});case"ADD_TODO":var c=e.form.data.assignedto.trim(),d=c.length&&!e.previouslyAssigned.includes(c)?o(o([],e.previouslyAssigned,!0),[c],!1):e.previouslyAssigned;return a(a({},e),{form:{invalid:[],data:(0,i.getEmptyFormData)(e.selectedCategory)},todos:o(o([],e.todos,!0),[u],!1),previouslyAssigned:d});case"REMOVE_TODO":return a(a({},e),{todos:e.todos.filter((function(e){return e.id!==u}))});case"TOGGLE_TODO_DONE":return a(a({},e),{todos:e.todos.map((function(e){return e.id!==u?e:a(a({},e),{done:!e.done})}))});case"UPDATE_TODO":return a(a({},e),{todos:e.todos.map((function(e){return e.id===u.id?u:e}))});case"CLEAR_SETTINGS":switch(u){default:return e;case"all":return s.defaultState;case"suggestions":return a(a({},e),{previouslyAssigned:[]});case"todos":return a(a({},e),{todos:[]})}case"ADD_CATEGORY":var f=u.trim(),g=f.length&&!e.categories.find((function(e){return e.name===f}))?o(o([],e.categories,!0),[{id:(0,r.nanoid)(),name:f}],!1):e.categories;return console.log("adding category",f,g),a(a({},e),{categories:g})}}},992:(e,t,n)=>{t.__esModule=!0,t.defaultState=void 0;var a=n(731),o=[{id:"work",name:"Work"},{id:"fun",name:"Fun"}];t.defaultState={username:"",todos:[],categories:o,previouslyAssigned:[],selectedCategory:o[0].id,form:{invalid:[],data:(0,a.getEmptyFormData)(o[0].id)}}},983:(e,t,n)=>{n.r(t),n.d(t,{customAlphabet:()=>i,customRandom:()=>r,nanoid:()=>s,random:()=>o,urlAlphabet:()=>a});let a="useandom-26T198340PX75pxJACKVERYMINDBUSHWOLF_GQZbfghjklqvwyzrict",o=e=>crypto.getRandomValues(new Uint8Array(e)),r=(e,t,n)=>{let a=(2<<Math.log(e.length-1)/Math.LN2)-1,o=-~(1.6*a*t/e.length);return(r=t)=>{let i="";for(;;){let t=n(o),s=o;for(;s--;)if(i+=e[t[s]&a]||"",i.length===r)return i}}},i=(e,t=21)=>r(e,t,o),s=(e=21)=>crypto.getRandomValues(new Uint8Array(e)).reduce(((e,t)=>e+((t&=63)<36?t.toString(36):t<62?(t-26).toString(36).toUpperCase():t>62?"-":"_")),"")}},t={};function n(a){var o=t[a];if(void 0!==o)return o.exports;var r=t[a]={exports:{}};return e[a].call(r.exports,r,r.exports,n),r.exports}n.d=(e,t)=>{for(var a in t)n.o(t,a)&&!n.o(e,a)&&Object.defineProperty(e,a,{enumerable:!0,get:t[a]})},n.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),n.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},(()=>{n(389);var e=n(302),t=n(718),a=n(809),o=(0,n(731).createStore)((0,t.loadState)()),r=o.dispatch,i=o.subscribe,s=o.getState;i((function(e){return document.getElementById("spy").innerText=JSON.stringify(e,null,2)})),i(t.saveState),i(a.render),(0,e.attachEventListeners)({document,dispatch:r,getState:s})})()})();